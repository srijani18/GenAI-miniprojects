pip install sentence-transformers numpy

from sentence_transformers import SentenceTransformer
import numpy as np


model = SentenceTransformer("sentence-transformers/all-MiniLM-L6-v2")

documents = [
    "Redis is an in-memory data store used for caching",
    "Spring Boot is a Java framework for building microservices",
    "PostgreSQL is a relational database system",
    "Semantic search finds results based on meaning",
    "Docker is used to containerize applications"
]

doc_embeddings = model.encode(documents)

def semantic_search(query, top_k=3):
    query_embedding = model.encode([query])[0]

    # Cosine similarity
    similarities = np.dot(doc_embeddings, query_embedding) / (
        np.linalg.norm(doc_embeddings, axis=1) * np.linalg.norm(query_embedding)
    )

    top_indices = similarities.argsort()[-top_k:][::-1]

    return [(documents[i], similarities[i]) for i in top_indices]

results = semantic_search("What is Redis used for?")

for text, score in results:
    print(f"{score:.3f} â†’ {text}")
